sudo: required
language: csharp
solution: ZombustersWindows.sln
services:
  - docker
before_install:
  - wget http://www.monogame.net/releases/v3.6/monogame-sdk.run
  - find * -type f -exec chmod 777 {} \; # lazy just make all executable
  #- docker pull suchja/wix WIX Not needed for now

install:
  # Extracted from http://community.monogame.net/t/running-monogame-sdk-run-on-linux-without-confirmation-travis-ci/9567
  - sudo apt-get install gtk-sharp3
  - sudo apt-get install libopenal-dev referenceassemblies-pcl ttf-mscorefonts-installer

  - echo y | sudo ./monogame-sdk.run

  - nuget restore
  #- nuget install NUnit.Runners -Version 2.6.4 -OutputDirectory testrunner
  #- ./travis/install_wine.sh
  #- sudo apt-get install wine
script:
  - find * -type f -exec chmod 777 {} \;
  - msbuild /t:ZombustersWindows /p:Configuration=Release
  # path where build /home/travis/build/retrowax/Zombusters/ZombustersWindows/bin/Windows/Release/ZombustersWindows.exe

  - zip -r zombusters_windows.zip /home/travis/build/retrowax/Zombusters/ZombustersWindows/bin/Windows/Release/

  # Deploy
  - wget https://dl.itch.ovh/butler/linux-386/head/butler
  - ./butler -V
  - ./butler login
  - ./butler push zombusters_windows.zip retrowax/zombusters:windows-beta

  #- mono ./testrunner/NUnit.Runners.2.6.4/tools/nunit-console.exe ./MonoGameSample.UnitTests/bin/Debug/MonoGameSample.UnitTests.dll
  #- (cd ZombustersWindows/Content && mono /opt/monogame-pipeline/MGCB.exe /rebuild /@:"Content.mgcb" /outputDir:"../bin/Release/Content")
