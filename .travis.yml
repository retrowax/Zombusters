sudo: required
language: csharp

before_install:
  - wget https://dl.itch.ovh/butler/linux-amd64/head/butler
  - find * -type f -exec chmod 777 {} \; # lazy just make all executable
  - wget https://gist.githubusercontent.com/ferranpons/1815fc02ffb744e7e06ccdabf42363da/raw/2d637e37e91131e075a4897abb98e1f7c240d443/twitterUpdate.py
  - source version.properties
  - export MAJOR MINOR PATCH
  - export SNAPSHOT_NOW=$(date +"%Y%m%d%H%M")

install:
  - sudo pip install tweepy

  # Install Monogame dependencies
  # Extracted from http://community.monogame.net/t/running-monogame-sdk-run-on-linux-without-confirmation-travis-ci/9567
  - sudo apt-get install gtk-sharp3
  - sudo apt-get install libopenal-dev referenceassemblies-pcl ttf-mscorefonts-installer

  # Install Butler
  - cp ./butler ~/bin
  - export PATH="$PATH:~/bin"

script:
  - find * -type f -exec chmod 777 {} \;

  - nuget restore ZombustersWindows.sln
  - msbuild /p:Configuration=Release ZombustersWindows.sln

  - nuget restore ZombustersMac.sln
  - msbuild /p:Configuration=Release ZombustersMac.sln

  - nuget restore ZombustersLinux.sln
  - msbuild /p:Configuration=Release ZombustersLinux.sln

#  - nuget restore ZombustersUWP.sln
#  - msbuild /p:Configuration=Release ZombustersUWP.sln

deploy:
  - provider: script
    script:
      ./travis/beta.sh
    on:
      tags: true
    skip_cleanup: true

#deploy:
#  - provider: script
#    script:
#      ./travis/release.sh
#    on:
#      tags: true
#    skip_cleanup: true

#  - provider: script
#    script:
#      ./travis/demo.sh
#    on:
#      branch: master
#    skip_cleanup: true

#after_deploy:
#  - ./travis/tweetAfterDeploy.sh
